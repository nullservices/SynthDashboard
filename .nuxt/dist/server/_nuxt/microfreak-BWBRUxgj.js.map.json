{"file":"microfreak-BWBRUxgj.js","mappings":";;;;;;;;;;;;;;AAkBA,MAAKA,cAAU;AAAA,EACb,OAAO;AAAA,IACL,OAAO;AAAA,EACR;AACH;;AAtBA,QAAA,OAAAC,eAAAC,WAAA,EACO,OAAM,gBADb,MAAA,CAAA,CAAA,WAAA;AAAAC,gBAGqB,OAAA,OAHrB,CAGa,SAAI;AAHjB,UAAA,wDAAAC,eASuC,EAAA,WAAA,UAAA,KAAK,KAAK,OAAA,CAAA,oCATjDC,eAWiC,KAAK,KAAK,kCAX3CA,eAYiC,KAAK,KAAK;;AAZ3C,QAAA,gBAAA;;;;;;;;;ACqBA,MAAKL,cAAU;AAAA,EACb,OAAO;AAAA,IACL,YAAY;AAAA,MACV,MAAM;AAAA,MACN,UAAU;AAAA,IACX;AAAA,IACD,gBAAgB;AAAA,MACd,MAAM;AAAA;AAAA,MACN,UAAU;AAAA,IACX;AAAA,EACF;AAAA,EACD,OAAO;AACL,WAAO;AAAA,MACL,WAAW;AAAA,QACT,EAAE,IAAI,GAAI;AAAA,QAAE,EAAE,IAAI;QAAM,EAAE,IAAI,GAAG;AAAA,QAAG,EAAE,IAAI;QAAM,EAAE,IAAI;QAAM,EAAE,IAAI,GAAI;AAAA,QAAE,EAAE,IAAI,GAAI;AAAA,QAClF,EAAE,IAAI,GAAI;AAAA,QAAE,EAAE,IAAI;QAAM,EAAE,IAAI,GAAG;AAAA,QAAG,EAAE,IAAI;QAAM,EAAE,IAAI;QAAM,EAAE,IAAI,GAAI;AAAA,QAAE,EAAE,IAAI,GAAI;AAAA,MACnF;AAAA,MACD,WAAW;AAAA,QACT,EAAE,IAAI,IAAI,UAAU;QAAK,EAAE,IAAI,IAAI,UAAU,GAAI;AAAA,QACjD,EAAE,IAAI,IAAI,UAAU,GAAI;AAAA,QAAE,EAAE,IAAI,IAAI,UAAU,GAAI;AAAA,QAAE,EAAE,IAAI,IAAI,UAAU,GAAI;AAAA,QAC5E,EAAE,IAAI,IAAI,UAAU,GAAG;AAAA,QAAG,EAAE,IAAI,IAAI,UAAU,GAAI;AAAA,QAClD,EAAE,IAAI,IAAI,UAAU,GAAI;AAAA,QAAE,EAAE,IAAI,IAAI,UAAU,GAAI;AAAA,QAAE,EAAE,IAAI,IAAI,UAAU,GAAI;AAAA,MAC7E;AAAA;EAEJ;AAAA,EACD,SAAS;AAAA,IACP,YAAY,OAAO;AACjB,YAAM,WAAW,KAAK,eAAe,KAAK,KAAK;AAC/C,UAAI,WAAW,GAAG;AAChB,cAAM,QAAQ,IAAI,WAAW;AAC7B,cAAM,gBAAgB,KAAK,IAAI,WAAW,GAAG,GAAG;AAChD,eAAO;AAAA,UACL,WAAW,SAAS,KAAK;AAAA,UACzB,WAAW,OAAO,gBAAgB,CAAC,gBAAgB,aAAa;AAAA,UAChE,QAAQ;AAAA;AAAA;MAEZ;AACA,aAAO;IACR;AAAA,EACF;AACH;;AA7DA,QAAA,OAAAC,eAAAC,WAAA,EACO,OAAM,wBADb,MAAA,CAAA,CAAA,2BAAA;AAAAC,gBAIoB,MAAA,WAJpB,CAIa,QAAG;AAJhB,UAAA,eAAAG,eAAA,CAAA,OAAA,SAAA,EAAA,QAMyC,kBAAW,SAAS,IAAI,EAAE,EAAA,CAAA,CAAA,aANnEF,eAOc,SAAW,YAAC,IAAI,EAAE,CAAA;;AAPhC,QAAA,kBAAA;AAAAD,gBAYoB,MAAA,WAZpB,CAYa,QAAG;AAZhB,UAAA,eAAAG,eAAA,CAAA,OAAA,SAAA,EAAA,QAcyC,kBAAW,SAAS,IAAI,EAAE,EAAA,CAAA,CAAA,aAdnEF,eAesB,EAAA,MAAA,IAAI,WAAQ,KAAA,GAAW,qBAAY,IAAI,EAAE,EAAA,CAAA;;AAf/D,QAAA,gBAAA;;;;;;;;;ACAO,SAAS,eAAe,UAAU;AACnC,MAAA,UAAW,mBAAmB;AAChC,YAAQ,MAAM,gDAAgD;AAC9D;AAAA,EAAA;AAGF,EAAA,SAAU,oBAAoB;AAAA,IAC5B,CAAC,eAAe;AACN,cAAA,IAAI,yBAAyB,UAAU;AAC/C,iBAAW,SAAS,WAAW,OAAO,OAAA,GAAU;AAC9C,gBAAQ,IAAI,8BAA8B,MAAM,IAAI,EAAE;AAChD,cAAA,gBAAgB,CAAC,YAAY;AACjC,gBAAM,CAAC,QAAQ,SAAS,KAAK,IAAI,QAAQ;AACnC,gBAAA,OACJ,WAAW,MACP,YACA,WAAW,MACX,aACA,WAAW,MACX,mBACA;AACG,mBAAA,SAAS,OAAO,IAAI;AAAA,QAC/B;AAAA,MAAA;AAAA,IAEJ;AAAA,IACA,CAAC,UAAU;AACD,cAAA,MAAM,kCAAkC,KAAK;AAAA,IAAA;AAAA,EAEzD;AACF;AChBA,MAAK,YAAU;AAAA,EACb,YAAY,EAAA,OAAEG,oBAAK,UAAEC,mBAAU;AAAA,EAC/B,OAAO;AACL,WAAO;AAAA,MACL,OAAO;AAAA,QACL,EAAE,IAAI,GAAG,OAAO,SAAS,OAAO,GAAG,OAAO,EAAG;AAAA,QAC7C,EAAE,IAAI,GAAG,OAAO,mBAAmB,OAAO,GAAG,OAAO,EAAG;AAAA,QACvD,EAAE,IAAI,IAAI,OAAO,QAAQ,OAAO,GAAG,OAAO,EAAG;AAAA,QAC7C,EAAE,IAAI,IAAI,OAAO,UAAU,OAAO,GAAG,OAAO,EAAG;AAAA,QAC/C,EAAE,IAAI,IAAI,OAAO,SAAS,OAAO,GAAG,OAAO,EAAG;AAAA,QAC9C,EAAE,IAAI,IAAI,OAAO,UAAU,OAAO,GAAG,OAAO,EAAG;AAAA,QAC/C,EAAE,IAAI,IAAI,OAAO,aAAa,OAAO,GAAG,OAAO,EAAG;AAAA,QAClD,EAAE,IAAI,KAAK,OAAO,oBAAoB,OAAO,GAAG,OAAO,EAAG;AAAA,QAC1D,EAAE,IAAI,KAAK,OAAO,oBAAoB,OAAO,GAAG,OAAO,EAAG;AAAA,QAC1D,EAAE,IAAI,IAAI,OAAO,oBAAoB,OAAO,GAAG,OAAO,EAAG;AAAA,QACzD,EAAE,IAAI,IAAI,OAAO,sBAAsB,OAAO,GAAG,OAAO,EAAG;AAAA,QAC3D,EAAE,IAAI,KAAK,OAAO,UAAU,OAAO,GAAG,OAAO,EAAG;AAAA,QAChD,EAAE,IAAI,KAAK,OAAO,iBAAiB,OAAO,GAAG,OAAO,EAAG;AAAA,QACvD,EAAE,IAAI,IAAI,OAAO,WAAW,OAAO,GAAG,OAAO,EAAG;AAAA,QAChD,EAAE,IAAI,IAAI,OAAO,iBAAiB,OAAO,GAAG,OAAO,EAAG;AAAA,QACtD,EAAE,IAAI,IAAI,OAAO,YAAY,OAAO,GAAG,OAAO,EAAG;AAAA,QACjD,EAAE,IAAI,IAAI,OAAO,gBAAgB,OAAO,GAAG,OAAO,EAAG;AAAA,MACtD;AAAA,MACD,YAAY,CAAE;AAAA,MACd,gBAAgB,CAAE;AAAA;EAErB;AAAA,EACD,SAAS;AAAA,IACP,kBAAkB,SAAS,OAAO,MAAM;AACtC,cAAQ,IAAI,0BAA0B,EAAE,SAAS,OAAO,KAAK,CAAC;AAC9D,UAAI,SAAS,WAAW;AACtB,cAAM,OAAO;AACb,YAAI,QAAQ,GAAG;AACb,cAAI,CAAC,KAAK,WAAW,SAAS,IAAI,EAAG,MAAK,WAAW,KAAK,IAAI;AAC9D,eAAK,KAAK,KAAK,gBAAgB,MAAM,KAAK;AAAA,eACrC;AACL,eAAK,aAAa,KAAK,WAAW,OAAO,CAAC,QAAQ,QAAQ,IAAI;AAC9D,eAAK,QAAQ,KAAK,gBAAgB,IAAI;AAAA,QACxC;AAAA,iBACS,SAAS,YAAY;AAC9B,cAAM,OAAO;AACb,aAAK,aAAa,KAAK,WAAW,OAAO,CAAC,QAAQ,QAAQ,IAAI;AAC9D,aAAK,QAAQ,KAAK,gBAAgB,IAAI;AAAA,MACxC;AACA,UAAI,SAAS,kBAAkB;AAC7B,cAAM,OAAO,KAAK,MAAM,KAAK,CAAC,MAAM,EAAE,OAAO,OAAO;AACpD,YAAI,MAAM;AACR,eAAK,QAAQ;AACb,eAAK,QAAS,QAAQ,MAAO,MAAM;AAAA,QACrC;AAAA,MACF;AAAA,IACD;AAAA,EACF;AAAA,EACD,UAAU;AACR,mBAAe,CAAC,SAAS,OAAO,SAAS;AACvC,WAAK,kBAAkB,SAAS,OAAO,IAAI;AAAA,IAC7C,CAAC;AAAA,EACF;AACH;;;;AAvEA,QAAA,OAAAP,eAAAC,WAAA,EACO,OAAM,0BADb,MAAA,CAAA,CAAA,sBAAA;AAAA,QAAAO,mBAAA,kBAAA,EAGY,OAAO,MAAK,MAAA,GAAA,MAAA,OAAA,CAAA;AAHxB,QAAAA,mBAAA,qBAAA;AAAA,IAIe,YAAY,MAAU;AAAA,IAAG,gBAAgB,MAAc;AAAA;AAJtE,QAAA,QAAA;;;;;;;;;","names":["_sfc_main","_ssrRenderAttrs","_mergeProps","_ssrRenderList","_ssrRenderStyle","_ssrInterpolate","_ssrRenderClass","Knobs","Keyboard","_ssrRenderComponent"],"sources":["../../../../components/Knobs.vue","../../../../components/Keyboard.vue","../../../../util/midi.js","../../../../pages/microfreak.vue"],"sourcesContent":["<template>\r\n  <div class=\"knobs-grid\">\r\n    <div\r\n      v-for=\"knob in knobs\"\r\n      :key=\"knob.id\"\r\n      class=\"knob-container\"\r\n    >\r\n      <div\r\n        class=\"knob\"\r\n        :style=\"{ transform: `rotate(${knob.angle}deg)` }\"\r\n      ></div>\r\n      <div class=\"knob-label\">{{ knob.label }}</div>\r\n      <div class=\"knob-value\">{{ knob.value }}</div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  props: {\r\n    knobs: Array,\r\n  },\r\n};\r\n</script>\r\n\r\n<style>\r\n.knobs-grid {\r\n  display: grid;\r\n  grid-template-columns: repeat(4, 1fr);\r\n  gap: 10px;\r\n  justify-items: center;\r\n}\r\n.knob-container {\r\n  text-align: center;\r\n  color: #ffcc00;\r\n}\r\n.knob {\r\n  width: 40px;\r\n  height: 40px;\r\n  border: 2px solid #ff6600;\r\n  border-radius: 50%;\r\n  background: radial-gradient(circle, #222, #111);\r\n}\r\n.knob:before {\r\n  content: \"\";\r\n  position: absolute;\r\n  top: 5px;\r\n  left: 50%;\r\n  width: 2px;\r\n  height: 10px;\r\n  background: #ffcc00;\r\n  transform-origin: bottom center;\r\n}\r\n.knob-label {\r\n  font-size: 0.6rem;\r\n}\r\n.knob-value {\r\n  font-size: 0.5rem;\r\n}\r\n</style>\r\n","<template>\r\n  <div class=\"keyboard-container\">\r\n    <!-- White Keys -->\r\n    <div\r\n      v-for=\"key in whiteKeys\"\r\n      :key=\"key.id\"\r\n      :class=\"['key', 'white', { active: activeKeys.includes(key.id) }]\"\r\n      :style=\"getKeyStyle(key.id)\"\r\n    ></div>\r\n\r\n    <!-- Black Keys -->\r\n    <div\r\n      v-for=\"key in blackKeys\"\r\n      :key=\"key.id\"\r\n      :class=\"['key', 'black', { active: activeKeys.includes(key.id) }]\"\r\n      :style=\"{ left: key.position + '%', ...getKeyStyle(key.id) }\"\r\n    ></div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  props: {\r\n    activeKeys: {\r\n      type: Array,\r\n      required: true,\r\n    },\r\n    velocityValues: {\r\n      type: Object, // Map of keyId -> velocity\r\n      required: true,\r\n    },\r\n  },\r\n  data() {\r\n    return {\r\n      whiteKeys: [\r\n        { id: 48 }, { id: 50 }, { id: 52 }, { id: 53 }, { id: 55 }, { id: 57 }, { id: 59 },\r\n        { id: 60 }, { id: 62 }, { id: 64 }, { id: 65 }, { id: 67 }, { id: 69 }, { id: 71 },\r\n      ],\r\n      blackKeys: [\r\n        { id: 49, position: 7 }, { id: 51, position: 13 },\r\n        { id: 54, position: 26 }, { id: 56, position: 33 }, { id: 58, position: 40 },\r\n        { id: 61, position: 53 }, { id: 63, position: 60 },\r\n        { id: 66, position: 73 }, { id: 68, position: 80 }, { id: 70, position: 87 },\r\n      ],\r\n    };\r\n  },\r\n  methods: {\r\n    getKeyStyle(keyId) {\r\n      const velocity = this.velocityValues[keyId] || 0;\r\n      if (velocity > 0) {\r\n        const scale = 1 + velocity / 127; // Scale based on velocity (e.g., 1.0 to ~2.0)\r\n        const glowIntensity = Math.min(velocity * 2, 255); // Max intensity at 255\r\n        return {\r\n          transform: `scale(${scale})`,\r\n          boxShadow: `0 0 ${glowIntensity / 4}px rgba(255, ${glowIntensity}, 0)`,\r\n          zIndex: 2, // Ensure the key is above others\r\n        };\r\n      }\r\n      return {};\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.keyboard-container {\r\n  position: relative;\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: flex-end;\r\n  width: 100%;\r\n  height: 200px;\r\n  background: #222;\r\n  border-radius: 10px;\r\n  border: 2px solid #444;\r\n  overflow: hidden;\r\n}\r\n\r\n/* White Keys */\r\n.key.white {\r\n  flex: 1;\r\n  height: 100%;\r\n  background: #fff;\r\n  border-right: 1px solid #ddd;\r\n  position: relative;\r\n  transition: transform 0.1s ease, box-shadow 0.1s ease;\r\n}\r\n\r\n.key.white:last-child {\r\n  border-right: none;\r\n}\r\n\r\n.key.white.active {\r\n  background: #ffcc00;\r\n}\r\n\r\n/* Black Keys */\r\n.key.black {\r\n  position: absolute;\r\n  width: 3%;\r\n  height: 60%;\r\n  background: #000;\r\n  top: 0;\r\n  transform: translateX(-50%);\r\n  border-radius: 3px;\r\n  z-index: 1;\r\n  transition: transform 0.1s ease, box-shadow 0.1s ease;\r\n}\r\n\r\n.key.black.active {\r\n  background: #ff3300;\r\n}\r\n</style>\r\n","export function initializeMIDI(callback) {\r\n  if (!navigator.requestMIDIAccess) {\r\n    console.error(\"Web MIDI API is not supported in this browser.\");\r\n    return;\r\n  }\r\n\r\n  navigator.requestMIDIAccess().then(\r\n    (midiAccess) => {\r\n      console.log(\"MIDI Access obtained:\", midiAccess);\r\n      for (const input of midiAccess.inputs.values()) {\r\n        console.log(`Connecting to MIDI device: ${input.name}`);\r\n        input.onmidimessage = (message) => {\r\n          const [status, control, value] = message.data;\r\n          const type =\r\n            status === 144\r\n              ? \"note_on\"\r\n              : status === 128\r\n              ? \"note_off\"\r\n              : status === 176\r\n              ? \"control_change\"\r\n              : \"unknown\";\r\n          callback(control, value, type);\r\n        };\r\n      }\r\n    },\r\n    (error) => {\r\n      console.error(\"Failed to access MIDI devices:\", error);\r\n    }\r\n  );\r\n}\r\n","<template>\r\n  <div class=\"microfreak-container\">\r\n    <h1>MicroFreak</h1>\r\n    <Knobs :knobs=\"knobs\" />\r\n    <Keyboard :activeKeys=\"activeKeys\" :velocityValues=\"velocityValues\" />\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport Knobs from \"~/components/Knobs.vue\";\r\nimport Keyboard from \"~/components/Keyboard.vue\";\r\nimport { initializeMIDI } from \"~/util/midi\";\r\n\r\nexport default {\r\n  components: { Knobs, Keyboard },\r\n  data() {\r\n    return {\r\n      knobs: [\r\n        { id: 5, label: \"Glide\", angle: 0, value: 0 },\r\n        { id: 9, label: \"Oscillator Type\", angle: 0, value: 0 },\r\n        { id: 10, label: \"Wave\", angle: 0, value: 0 },\r\n        { id: 12, label: \"Timbre\", angle: 0, value: 0 },\r\n        { id: 13, label: \"Shape\", angle: 0, value: 0 },\r\n        { id: 23, label: \"Cutoff\", angle: 0, value: 0 },\r\n        { id: 83, label: \"Resonance\", angle: 0, value: 0 },\r\n        { id: 102, label: \"Cycling Env Rise\", angle: 0, value: 0 },\r\n        { id: 103, label: \"Cycling Env Fall\", angle: 0, value: 0 },\r\n        { id: 28, label: \"Cycling Env Hold\", angle: 0, value: 0 },\r\n        { id: 24, label: \"Cycling Env Amount\", angle: 0, value: 0 },\r\n        { id: 105, label: \"Attack\", angle: 0, value: 0 },\r\n        { id: 106, label: \"Decay/Release\", angle: 0, value: 0 },\r\n        { id: 29, label: \"Sustain\", angle: 0, value: 0 },\r\n        { id: 26, label: \"Filter Amount\", angle: 0, value: 0 },\r\n        { id: 94, label: \"LFO Rate\", angle: 0, value: 0 },\r\n        { id: 92, label: \"ARP/SEQ Rate\", angle: 0, value: 0 },\r\n      ],\r\n      activeKeys: [],\r\n      velocityValues: {},\r\n    };\r\n  },\r\n  methods: {\r\n    handleMIDIMessage(control, value, type) {\r\n      console.log(\"Received MIDI message:\", { control, value, type });\r\n      if (type === \"note_on\") {\r\n        const note = control;\r\n        if (value > 0) {\r\n          if (!this.activeKeys.includes(note)) this.activeKeys.push(note);\r\n          this.$set(this.velocityValues, note, value);\r\n        } else {\r\n          this.activeKeys = this.activeKeys.filter((key) => key !== note);\r\n          this.$delete(this.velocityValues, note);\r\n        }\r\n      } else if (type === \"note_off\") {\r\n        const note = control;\r\n        this.activeKeys = this.activeKeys.filter((key) => key !== note);\r\n        this.$delete(this.velocityValues, note);\r\n      }\r\n      if (type === \"control_change\") {\r\n        const knob = this.knobs.find((k) => k.id === control);\r\n        if (knob) {\r\n          knob.value = value;\r\n          knob.angle = (value / 127) * 270 - 135;\r\n        }\r\n      }\r\n    },\r\n  },\r\n  mounted() {\r\n    initializeMIDI((control, value, type) => {\r\n      this.handleMIDIMessage(control, value, type);\r\n    });\r\n  },\r\n};\r\n</script>\r\n\r\n<style>\r\n.microfreak-container {\r\n  width: 800px;\r\n  height: 600px;\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n  background: linear-gradient(135deg, #1a1a1a, #333);\r\n  color: #fff;\r\n  padding: 10px;\r\n  border: 2px solid #00ffcc;\r\n  border-radius: 10px;\r\n  overflow: hidden;\r\n}\r\nh1 {\r\n  font-size: 1.2rem;\r\n}\r\n</style>\r\n"],"version":3}